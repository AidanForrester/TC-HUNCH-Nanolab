<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Set the character encoding for proper text rendering -->
  <meta charset="UTF-8">

  <!-- Ensures compatibility mode is disabled in old versions of Internet Explorer -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!-- Makes the page responsive across all devices and screen sizes -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Page title as it appears in the browser tab -->
  <title>Analytics</title>
  <!--Favicon -->
  <link rel="icon" type="X" href="../images/Tri-CountyLogo.png">
  <!-- Connects the external stylesheet that defines layout, colors, and responsiveness -->
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <!-- ===========================
       NAVIGATION BAR
       =========================== -->
  <nav>
    <!-- ===========================
         SIDEBAR MENU (MOBILE VIEW)
         =========================== -->
    <!-- This menu is hidden by default (CSS: display:none)
         and only becomes visible when the hamburger icon is clicked. -->
    <ul class="sidebar">

      <!-- Close ("X") button â€” triggers hideSidebar() when clicked -->
      <li onclick="hideSidebar()">
        <a href="#">
          <!-- SVG X icon -->
          <svg xmlns="http://www.w3.org/2000/svg" height="26" width="26" viewBox="0 96 960 960">
            <path d="m249 849-42-42 231-231-231-231 42-42 
                     231 231 231-231 42 42-231 231 
                     231 231-42 42-231-231-231 231Z"/>
          </svg>
        </a>
      </li>

      <!-- Vertical list of navigation links (stacked in a column via flex-direction: column) -->
      <!-- These replicate the main navbar links but are shown in the sidebar on mobile -->
      <li><a href="index.html">Dashboard</a></li>
      <li><a href="analytics.html">Analytics</a></li>
      <li><a href="controls.html">Controls</a></li>
      <li><a href="settings.html">Settings</a></li>
      <li><a href="about.html">About</a></li>
    </ul>

    <!-- ===========================
         MAIN NAVBAR (DESKTOP VIEW)
         =========================== -->
    <!-- This <ul> is always visible on desktop screens.
         On smaller screens (<1320px), CSS hides most links
         and shows only the hamburger button. -->
    <ul>
      <!-- Project name (aligned left via nav li:first-child { margin-right:auto; }) -->
      <li><a href="#">TC NANOLABS HUNCH</a></li> <!--Top Left Name-->

      <!-- Standard navigation links.
           These are visible on desktop but hidden on smaller screens (CSS: .hideOnMobile {display:none}) -->
      <li class="hideOnMobile"><a href="index.html">Dashboard</a></li>
      <li class="hideOnMobile"><a href="analytics.html">Analytics</a></li>
      <li class="hideOnMobile"><a href="controls.html">Controls</a></li>
      <li class="hideOnMobile"><a href="settings.html">Settings</a></li>
      <li class="hideOnMobile"><a href="about.html">About</a></li>

      <!-- ===========================
           MENU BUTTON (HAMBURGER ICON)
           =========================== -->
      <!-- Hidden by default (CSS: display:none).
           Appears when screen width <1320px via media query.
           Clicking it calls showSidebar() to display the sidebar. -->
      <li class="menu-button" onclick="showSidebar()">
        <a href="#">
          <!-- SVG Hamburger icon (three horizontal bars) -->
          <svg xmlns="http://www.w3.org/2000/svg" height="26" width="26" viewBox="0 96 960 960">
            <path d="M120 816v-60h720v60H120Z
                     M120 606v-60h720v60H120Z
                     M120 396v-60h720v60H120Z"/>
          </svg>
        </a>
      </li>
    </ul>
  </nav>

  <!-- ===========================
       JAVASCRIPT FUNCTIONALITY
       =========================== -->
  <script>
    // When user clicks the hamburger icon:
    // - Select the sidebar element.
    // - Change its display property from "none" to "flex".
    //   (CSS flex layout stacks items vertically.)
    function showSidebar() {
      const sidebar = document.querySelector('.sidebar')
      sidebar.style.display = 'flex'
    }

    // When user clicks the X icon:
    // - Hide the sidebar again by setting display to "none".
    function hideSidebar() {
      const sidebar = document.querySelector('.sidebar')
      sidebar.style.display = 'none'
    }
  </script>

  <main>
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Live Moisture Chart</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    #chart-container {
      width: 80%;
      margin: auto;
    }
    #moist2 {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>Live Moisture Data: <span id="moist2">--</span></h2>
  <div id="chart-container">
    <canvas id="moistureChart"></canvas>
  </div>
  <button onclick="exportChart()">Export Chart as Image</button>

  <script>
    const ctx = document.getElementById('moistureChart').getContext('2d');
    const moistureChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [],
        datasets: [{
          label: 'Moisture Level',
          data: [],
          borderColor: 'blue',
          backgroundColor: 'rgba(0, 0, 255, 0.1)',
          fill: true,
          tension: 0.4
        }]
      },
      options: {
        responsive: true,
        scales: {
          x: { title: { display: true, text: 'Time' }},
          y: { title: { display: true, text: 'Moisture' }}
        }
      }
    });

    function updateChart() {
      const moistValue = document.getElementById('moist2').textContent;
      const value = parseFloat(moistValue);
      if (!isNaN(value)) {
        const now = new Date().toLocaleTimeString();
        moistureChart.data.labels.push(now);
        moistureChart.data.datasets[0].data.push(value);
        if (moistureChart.data.labels.length > 20) {
          moistureChart.data.labels.shift();
          moistureChart.data.datasets[0].data.shift();
        }
        moistureChart.update();
      }
    }

    function exportChart() {
      const link = document.createElement('a');
      link.href = moistureChart.toBase64Image();
      link.download = 'moisture_chart.png';
      link.click();
    }

    // Simulate live updates every 2 seconds
    setInterval(() => {
      // Simulate changing the span value (replace with real sensor update logic)
      document.getElementById('moist2').textContent = (Math.random() * 20).toFixed(2);
      updateChart();
    }, 3000);
  </script>
</body>
</html>
 </main>
</body>
</html>


