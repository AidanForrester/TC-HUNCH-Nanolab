<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Set the character encoding for proper text rendering -->
  <meta charset="UTF-8">

  <!-- Ensures compatibility mode is disabled in old versions of Internet Explorer -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!-- Makes the page responsive across all devices and screen sizes -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Page title as it appears in the browser tab -->
  <title>Dashboard</title>
  <!--Favicon -->
  <link rel="icon" type="X" href="../images/Tri-CountyLogo.png">
  <!-- Connects the external stylesheet that defines layout, colors, and responsiveness -->
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <!-- ===========================
       NAVIGATION BAR
       =========================== -->
  <nav>
    <!-- ===========================
         SIDEBAR MENU (MOBILE VIEW)
         =========================== -->
    <!-- This menu is hidden by default (CSS: display:none)
         and only becomes visible when the hamburger icon is clicked. -->
    <ul class="sidebar">

      <!-- Close ("X") button — triggers hideSidebar() when clicked -->
      <li onclick="hideSidebar()">
        <a href="#">
          <!-- SVG X icon -->
          <svg xmlns="http://www.w3.org/2000/svg" height="26" width="26" viewBox="0 96 960 960">
            <path d="m249 849-42-42 231-231-231-231 42-42
                     231 231 231-231 42 42-231 231
                     231 231-42 42-231-231-231 231Z"/>
          </svg>
        </a>
      </li>

      <!-- Vertical list of navigation links (stacked in a column via flex-direction: column) -->
      <!-- These replicate the main navbar links but are shown in the sidebar on mobile -->
      <li><a href="index.html">Dashboard</a></li>
      <li><a href="analytics.html">Analytics</a></li>
      <li><a href="controls.html">Controls</a></li>
      <li><a href="settings.html">Settings</a></li>
      <li><a href="about.html">About</a></li>
    </ul>

    <!-- ===========================
         MAIN NAVBAR (DESKTOP VIEW)
         =========================== -->
    <!-- This <ul> is always visible on desktop screens.
         On smaller screens (<1320px), CSS hides most links
         and shows only the hamburger button. -->
    <ul>
      <!-- Project name (aligned left via nav li:first-child { margin-right:auto; }) -->
      <li><a href="index.html">TC NANOLABS HUNCH</a></li> <!--Top Left Name-->

      <!-- Standard navigation links.
           These are visible on desktop but hidden on smaller screens (CSS: .hideOnMobile {display:none}) -->
      <li class="hideOnMobile"><a href="index.html">Dashboard</a></li>
      <li class="hideOnMobile"><a href="analytics.html">Analytics</a></li>
      <li class="hideOnMobile"><a href="controls.html">Controls</a></li>
      <li class="hideOnMobile"><a href="settings.html">Settings</a></li>
      <li class="hideOnMobile"><a href="about.html">About</a></li>

      <!-- ===========================
           MENU BUTTON (HAMBURGER ICON)
           =========================== -->
      <!-- Hidden by default (CSS: display:none).
           Appears when screen width <1320px via media query.
           Clicking it calls showSidebar() to display the sidebar. -->
      <li class="menu-button" onclick="showSidebar()">
        <a href="#">
          <!-- SVG Hamburger icon (three horizontal bars) -->
          <svg xmlns="http://www.w3.org/2000/svg" height="26" width="26" viewBox="0 96 960 960">
            <path d="M120 816v-60h720v60H120Z
                     M120 606v-60h720v60H120Z
                     M120 396v-60h720v60H120Z"/>
          </svg>
        </a>
      </li>
    </ul>
  </nav>

<main>
    <h1>Dashboard</h1> <!--Main Header-->
    <h2>Current Sensor Values</h2> <!-- Sub Header -->

    <h3>&#8203;</h3> <!-- Transparent Line Break -->
    <data style="color: white;">Humidity: <span id="humidity">--</span>%</data>     <!--Fetches humidity-->
    <data style="color:white">Temperature: <span id="temp">--</span>°C</data>   <!--Fetches temp Variable-->
    <data style="color:white">Total Dissolved Solids: <span id="tds">--</span> ppm</data>
    <data style="color: white;">VOC: <span id="VOC">--</span> kΩ</data>

    <h3>&#8203;</h3>

    <data style="color:rgb(255, 255, 255)">Upper Moisture Sensor: <span id="moist2">--</span>%</data>
    <data style="color:white">Lower Moisture Sensor: <span id="moist1">--</span>%</data>
    <h3>&#8203;</h3>

    <h2>Live Camera View</h2> <!-- Sub Header -->
<img id="bg" src="/video_feed" class="teamphoto">
/main>

 <!-- ===========================
       JAVASCRIPT FUNCTIONALITY
       =========================== -->
  <script>

    // When user clicks the hamburger icon:
    // - Select the sidebar element.
    // - Change its display property from "none" to "flex".
    //   (CSS flex layout stacks items vertically.)
    function showSidebar() {
      const sidebar = document.querySelector('.sidebar')
      sidebar.style.display = 'flex'
    }

    // When user clicks the X icon:
    // - Hide the sidebar again by setting display to "none".
    function hideSidebar() {
      const sidebar = document.querySelector('.sidebar')
      sidebar.style.display = 'none'
    }
</script>
<script>
async function updateData() {
    try {
        const response = await fetch('/sensor_data');
        const data = await response.json();
        document.getElementById('humidity').innerText = data.humidity;
        document.getElementById('temp').innerText = data.temperature;
        document.getElementById('moist1').innerText = data.moist1;
        document.getElementById('moist2').innerText = data.moist2;
        document.getElementById('tds').innerText = data.tds;
        document.getElementById('VOC').innerText = data.VOC;

    } catch (err) {
        console.error('Failed to fetch sensor data:', err);
    }
}
updateData();
setInterval(updateData, 1000);
</script>
</body>
</html>

